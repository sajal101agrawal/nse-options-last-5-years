# ğŸ“ˆ NSE Options Data Analysis (2020â€“2025)

This project is built to **analyze NSE (National Stock Exchange) options data** over the past 5 years. It combines historical market data with financial modeling to compute **implied volatility (IV)**, **realized volatility (RV)**, **Black-Scholes Greeks**, **earnings calendar alignment**, and **interest rate integration** for each option.

> ğŸ“… **Data Range:** Apr-2020 to Apr-2025  
> ğŸ› ï¸ **Primary Use Case:** Quantitative Research, Options Analytics, and AI Training  
> âš ï¸ **Disclaimer:** This is for educational and research use only. Follow NSEâ€™s data policies.

---

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ bhavcopy/extracted         # Raw NSE Bhavcopy files
â”œâ”€â”€ earning_dates/             # Earnings dates (JSON format)
â”œâ”€â”€ interest_rates/            # MIFOR interest rate CSVs
â”œâ”€â”€ yahoo_finance/             # Underlying stock prices from Yahoo Finance
â”œâ”€â”€ processed_data/            # Final enriched dataset output
â”œâ”€â”€ download_bhavcopy.py       # Downloader for historical bhavcopies
â”œâ”€â”€ download_yahoo_data.py     # Script to fetch Yahoo historical prices
â”œâ”€â”€ nse_fno_scripts.py         # Script to generate NSE F&O scripts list
â”œâ”€â”€ process_data.py            # Main processor to calculate IV, RV, Greeks, etc.
â””â”€â”€ nse_fno_scripts.json       # NSE F&O symbols
```

---

## âœ¨ Key Features

- ğŸ“… **5 Years of Options Data** with expiry tracking (30d/60d/90d)
- ğŸ“ˆ **Implied Volatility (IV)** via Black-Scholes & bisection method
- ğŸ“‰ **Realized Volatility (RV)** using **Yang-Zhang model**
- ğŸ§® **Greeks Calculation**: Delta, Gamma, Theta, Vega, Rho
- ğŸ’¡ **IV Percentile & Rank** (30-day rolling window)
- ğŸ“Š **Interest Rate Fallback Logic** using FBIL MIFOR data
- ğŸ§  **AI/ML Ready Output**: structured JSON suitable for training or analytics
- ğŸ“† **Earnings Date Mapping** from Sensibull API
- ğŸ’¾ **Optimized JSON Output** for scalable querying or dashboard integration

---

## âš™ï¸ Setup & Requirements

**Python Version:** 3.7+  
**Dependencies:**
```bash
pip install pandas numpy requests pytz python-dateutil beautifulsoup4
```

---

## ğŸš€ How to Use

### 1. Download Bhavcopy Files
```bash
python download_bhavcopy.py
```
> âœ… Recent bhavcopies are sourced from [SAMCO Bhavcopy Archive](https://www.samco.in/bhavcopy-nse-bse-mcx)

---

### 2. Download Underlying Spot Prices (Yahoo Finance)
```bash
python download_yahoo_data.py
```
> Downloads `{symbol}_processed.json` for every script in `yahoo_finance/`

---

### 3. Process & Analyze
```bash
python process_data.py
```
> Merges bhavcopy + interest + earnings + spot prices and computes:
- IV30, IV60, IV90 for CE and PE
- Realized Volatility (Yang-Zhang)
- IV Percentile & Rank (30-day rolling)
- Greeks: Î”, Î“, Î˜, Î½, Ï
- Upcoming earnings alignment

Saves results in: `processed_data/processed_data.json`

---

## ğŸ§  Sample Output Format

Path: `processed_data/processed_data.json`

```json
{
  "historical": {
    "scripts": {
      "HDFCBANK": {
        "exchange": "NSE",
        "segment": "Options",
        "09-Apr-2025": {
          "underlying_price": 1765.0,
          "interest_rate": 7.7556,
          "upcoming_earning_date": "19-Apr-2025",
          "expiry_30d": "24-Apr-2025",
          "expiry_60d": "29-May-2025",
          "expiry_90d": "26-Jun-2025",
          "strike_price": 1760.0,
          "rv_yz": 12.0535,
          "ce": {
            "iv_30": 21.40,
            "iv_60": 15.17,
            "iv_90": 19.60,
            "volume": 89185,
            "last_price_30d": 42.4,
            "open": 45.25,
            "high": 47.85,
            "low": 37.25,
            "close": 42.4,
            "ivp": 93.33,
            "ivr": 0.9024,
            "greeks": {
              "delta": 0.56,
              "gamma": 0.0042,
              "theta": -1.01,
              "vega": 1.70,
              "rho": 0.56
            }
          },
          "pe": {
            "iv_30": 21.59,
            "iv_60": 20.89,
            "iv_90": 21.02,
            "volume": 47362,
            "last_price_30d": 31.7,
            "open": 29.5,
            "high": 37.65,
            "low": 28.65,
            "close": 31.7,
            "ivp": 96.67,
            "ivr": 0.9496,
            "greeks": {
              "delta": -0.44,
              "gamma": 0.0042,
              "theta": -0.69,
              "vega": 1.70,
              "rho": -0.48
            }
          }
        }
      }
    }
  }
}
```

---

## ğŸ“˜ Data Sources

- **NSE Bhavcopy:** [SAMCO Archive](https://www.samco.in/bhavcopy-nse-bse-mcx)
- **Interest Rates:** [FBIL Adjusted MIFOR](https://www.fbil.org.in/#contentA)
- **Earnings Dates:** `https://oxide.sensibull.com/v1/compute/market_stock_events`
- **Underlying Prices:** Yahoo Finance (via `chart` API)

---

## ğŸ”® Future Enhancements

- ğŸ›°ï¸ **Real-time Option Chain** using broker APIs (e.g., Dhan)
- ğŸ”— **NoSQL Database Integration** for faster querying
- ğŸ“¡ **IV Spike Prediction Model** around earnings
- ğŸ“º **React/Django Dashboard** to visualize insights

---

## ğŸ” License

Open for non-commercial research and education only. Please review data source terms from NSE, FBIL, Yahoo, Sensibull, and SAMCO.

---

## ğŸ‘¨â€ğŸ’» Author

**Sajal Agrawal**  
Founder, Sajal Tech Solutions Private Limited  
ğŸŒ [sajaltech.com](https://sajaltech.com) | âœ‰ï¸ sajal@sajaltech.com | ğŸ“ +91-8440898969

---

## ğŸ¤ Contributions

Pull requests, forks, and feedback are welcome! Letâ€™s push the frontier of options analytics together ğŸš€
